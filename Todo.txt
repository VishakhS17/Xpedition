Xpedition To Do:
Clarifying: enquiries aren't deleted when a bike is sold. Updating the approach to track popularity by model, not just by bike ID:


[4 tools called]


Enquiries aren't deleted when a bike is sold. Updating the approach to track popularity by model, not just by bike ID:


[1 tool called]


## How it works

### 1. Enquiries are not deleted
- When a bike is sold/deleted, the `bike_id` in enquiries becomes `NULL` (due to `ON DELETE SET NULL`)
- The enquiry record remains with the `bike_model` stored
- Historical data is preserved

### 2. Two ways to track popularity

#### Option A: Popular specific bikes (currently available)
```sql
SELECT * FROM popular_bikes LIMIT 10;
```
- Shows specific bike instances that are currently available
- Based on enquiries for those specific bikes
- When a bike is sold, it disappears from this list

#### Option B: Popular bike models (all time)
```sql
SELECT * FROM popular_bike_models LIMIT 10;
```
- Shows popularity by model (e.g., "KAWASAKI Z900 ABS")
- Tracks all enquiries for that model, even if specific bikes are sold
- Example: "KAWASAKI Z900 ABS" has 50 total enquiries (across all instances)

## What I added

1. `bike_model` stored in enquiries (NOT NULL)
   - Even if bike is deleted, we know which model it was

2. `bike_brand` stored in enquiries
   - Better tracking and grouping

3. `popular_bike_models` view
   - Groups enquiries by model
   - Shows total enquiries per model
   - Works even after bikes are sold

## Example scenario

1. You have 3 "KAWASAKI Z900 ABS" bikes
2. Each gets 10 enquiries = 30 total enquiries
3. All 3 bikes are sold
4. Result:
   - `popular_bikes` view: No bikes shown (all sold)
   - `popular_bike_models` view: Still shows "KAWASAKI Z900 ABS" with 30 enquiries

## For your admin dashboard

You can show:
- Currently popular bikes: Use `popular_bikes` (only available bikes)
- All-time popular models: Use `popular_bike_models` (even if sold)

This lets you track both current inventory popularity and historical model popularity.

The migration is updated and ready to use.